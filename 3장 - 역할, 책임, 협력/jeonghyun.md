# 3장 역할, 책임, 협력

### 협력

- 협력은 객체를 설계하는 데 필요한 **문맥**을 제공한다.
- 협력은 기능을 구현할 수 있는 **유일한 방법**이다.

### 책임

- 책임이란
  1. **하는 것**
  2. **아는 것**
- 책임은 메시지보다 추상적이고 더 큰 개념이다.
- 협력을 설계하는 출발점은 시스템이 사용자에게 제공하는 **"기능"**을 시스템이 담당할 **"하나의 책임"**으로 바라보는 것이다.

#### 책임 주도 설계

1. "예매" 기능을 제공하고자 한다.
   - "예매하라" 라는 메시지를 전송하고 싶은데 누구한테 보내야할까?
   - 이 때 "예매"라는 기능(책임)을 담당할 후보가 필요하게 된다.
     - 후술하겠지만 "후보"라는 단어를 선택한 이유는 이 후보가 객체가 될 수도 역할이 될 수도 있기 때문이다.
   - 적합한 후보를 찾는 방법은 해당 기능을 제공하기 위해 필요한 정보를 소유하고 있거나 해당 정보의 소유자를 가장 잘 알고 있는 전문가를 찾는 것이다. (page 82)
   - 우리는 후보로 `Screening`을 선정하였다.
     - 왜냐하면 `Screening`은 상영 정보를 알고 있기 때문에.
     - 이제 `Screening`은 "예매"라는 책임을 갖게 되었다.
2. "예매"를 하기 위해서는 "요금 계산"이 필요하다.
   - 마찬가지로 "요금을 계산해"라는 메시지를 처리할 후보를 찾는다.
   - 영화의 가격과 할인 정책을 알고 있는 `Movie`를 선정하자.
   - `Movie`는 "요금 계산"이라는 책임을 갖게 되었다.

정리하자면 **책임 주도 설계**는

1. 책임을 찾고
2. 책임을 수행할 적절한 책체를 찾아
3. 책임을 할당하는 방식으로 협력을 설계한다.

#### 행동이 상태를 결정한다

- 객체가 협력에 적합한지를 결정하는 것은 객체의 상태가 아니라 행동이다.
- 객체의 내부 구현에 초점을 맞춘 설계 방법을 **데이터-주도-설계(DDD)** 라고 부르며
  - 이는 캡슐화를 저해한다.
- 따라서 객체의 상태는 행동을 결정하고 나서 결정해야 한다.

### 역할

- 특정한 협력 안에서 수행하는 책임의 집합을 **역할**이라고 부른다.
  - 여기서 집합이란 인터페이스 혹은 추상클래스로 비유될 수 있다.
  - 왜냐하면 책임=기능 이라고 보았을 때 해당 기능을 수행하는 객체가 여러 형태일 수 있기 때문이다.

#### 객체, 역할

- 동일한 책임을 수행하는 객체들을 역할로 통합할 수 있다.
- 역할의 장점은 설계가 좀 더 유연해진다.
- 하지만 처음부터 역할을 생각해내기 쉽지 않을 수 있다.
  - 이럴 경우에는 구체적인 객체로 설계를 시작하고,
  - 유사한 협력들을 합치다 보면 자연스럽게 역할이 눈에 보일 것이다.

### 느낀점

책임 주도 설계에서는 책임을 수행할 적절한 객체를 찾을 때에 "필요한 정보를 소유하고 있거나 해당 정보의 소유자를 가장 잘 알고 있는 전문가를 찾는 것" 이라고 나와있다. 하지만 이러한 방식은 객체의 내부 구현에 초점을 맞춘 방식(데이터 주도 설계) 이라는 생각이 들었다.

즉, 협력할 객체를 객체의 행동에서 찾는 것이 아닌 상태에서 찾는 방식인 것이다. 이러한 방식으로 협력을 할 경우 객체가 강하게 결합하여 캡슐화가 저해된다. 

"책임 주도 설계" 라는 방식을 독자에게 이해하기 쉽게 하기 위해 이렇게 설명한 것인지는 모르겠지만 데이터보다는 행동을 먼저 결정해야 한다는 방식과 조금 모순이 생기는 것 같아 적어보았다.

