# 2장 객체지향 프로그래밍

### 협력하는 객체들의 공동체

#### Money

- 금액을 구현하기 위해 Long이 아닌 하나의 인스터스 변수를 가지는 Money 타입을 지정했다.
- 이를 통해 금액과 관련된 로직을 한 곳에서 관리할 수 있다.
- 위와 같이 객체를 이용해 도메인의 의미를 풍부하게 표현하는 것은 전체적인 설계의 명확성과 유연성을 높이는 첫걸음이다.

#### 객체지향 프로그램을 작성할 때는

- 먼저 **협력의 관점**에서 어떤 객체가 필요한지를 결정해야 한다.
- 흔히들 클래스와 멤버변수를 먼저 설계하는 실수를 범하는데, **객체**와 **협력**의 관점으로 프로그램을 먼저 바라보자.

#### 메시지와 메서드를 구별하자.

- 객체가 다른 객체와 상호작용할 수 있는 유일한 방법은 **메시지**이다.
- 객체가 수신된 메시지를 처리하기 위한 자신만의 방법을 **메서드**라고 부른다.
  - 메시지를 보내는 객체는 수신 객체가 어떻게 메시지를 처리하는지(==어떤 메서드가 실행될 지) 알지 못한다.
  - 메시지를 처리하는 방법은 메시지를 수신하는 객체가 **자율적으로** 결정한다.
- 위와 같은 내용을 **다형성**이라고 한다.

#### TEMPLATE METHOD 패턴

- 부모 클래스에 기본적인 알고리즘의 흐름을 구현하고 중간에 필요한 처리를 자식 클래스에게 위임.

### 컴파일 시간 의존성과 실행 시간 의존성

- 유연한 설계의 경우 코드의 의존성과 실행 시점의 의존성이 서로 다르다.
- 하지만 코드의 의존성과 실행 시점의 의존성이 다르면 코드를 이해하기 어려워진다.
- 이를 **의존성의 양면성** 이라 부르며, 우리는 항상 유연성과 가독성 사이의 트레이드오프를 고민해야 한다.

### 구현 상속과 인터페이스 상속

- 구현 상속: 순수하게 코드를 재사용하기 위한 목적의 상속
- 인터페이스 상속: 다형적인 협력을 위해 부모 클래스와 자식 클래스가 인터페이스를 공유하기 위한 목적의 상속
- **상속은 구현 상속이 아니라 인터페이스 상속을 위해 사용해야 한다.**
  - 구현을 재사용할 목적으로 상속을 사용하면 변경에 취약한 코드를 낳게 될 확률이 높다.

### 추상화의 장점

- 요구사항의 정책을 높은 수준에서 서술할 수 있다.
  - 세부적인 내용을 무시한 채 추상적인 개념만으로 도메인의 핵심을 설명할 수 있다.
- 설계가 좀 더 유연해진다.

### 코드 재사용: 상속과 합성

#### 상속은 설계에 안 좋은 영향을 미친다.

- 상속은 캡슐화를 위반한다.
  - 상속을 하기 위해서는 부모 클래스의 구현이 자식 클래스에게 노출된다.
  - 즉, 자식 클래스가 부모 클래스에 강하게 결합되기 때문에 부모 클래스의 변경이 자식 클래스에 영향을 줄 수 있다.
- 설계를 유연하지 못하게 만든다.
  - 상속은 부모와 자식의 관계를 **컴파일 시점**에 결정한다.
  - 따라서 **실행 시점에 객체의 종류를 변경하는 것이 불가능하다.**

#### 상속보다는 합성을 선호하는 것이 더 좋은 방법이다.

- 합성은 인터페이스에 정의된 메시지를 통해서만 코드를 재사용한다.
- 메시지의 내부 구현을 몰라도 되기 때문에 구현을 효과적으로 캡슐화 할 수 있다.
- 또한 의존하는 인스턴스를 교체하는 것이 비교적 수월하다.

## 느낀점

 책을 읽으면서 객체지향 생활체조 원칙에 나오는 **일급 컬렉션**이라는 용어를 같이 찾아보았다. 일급 컬렉션이란 하나의 Collection 인스턴스 변수를 가지는 클래스를 말한다. 바로 이 일급 컬렉션이 **상속**과 **합성**의 적합한 예가 될 것 같다.

 이전에 알고리즘 문제를 풀 때 나만의 Collection을 사용하고 싶어서 ArrayList를 상속하는 Collection을 구현한 경험이 있었다. 그 때 느꼈던 점은 내가 구현한 Collection이 ArrayList에 강하게 엮여있고, 나중에 LinkedList로의 변환이 굉장히 어려웠다는 점이다.

 반면, 일급 컬렉션은 Collection 인터페이스를 멤버변수로 갖기 때문에 효과적인 캡술화가 가능하다. 이를 통해 위의 문제점들을 쉽게 해결함과 동시에 Collection에 내가 원하는 로직을 추가할 수 있다.



