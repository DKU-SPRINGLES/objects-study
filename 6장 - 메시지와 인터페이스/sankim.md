# 메시지와 인터페이스

## 협력과 메시지

### 클라이언트-서버 모델

- 두 객체 사이의 협력 관계를 설명하기 위해 사용하는 전통적인 메타포
- 클라이언트 : 메시지를 전송하는 객체
- 서버 : 메시지를 수신하는 객체

### 메시지와 메시지 전송

- 메시지 전송 : 다른 객체에 도움을 요청하는 것
- condition.isSatisfiedBy(screening)
    - **condition** 이라는 객체에 **isSatisfiedBy(screening)**이라는 메시지를 전송
    - **isSatisfiedBy** 는 **오퍼레이션명, screening** 은 **인자**

### 메시지와 메서드

- 메서드 : 메시지를 수신했을 때 실제로 실행되는 함수 또는 프로시저
- 객체지향은 메시지 전송과 메시지 호출을 명확하게 구분한다
    - 다형성으로 인해 메시지를 코드상에 표기하는 시점에는 어떤 메시지가 실행될지 명확하게 알수 없다.
    - 메시지 전송자는 자신이 어떤 메시지를 전송해야 하는지만 알면 된다.
    - 메시지 수신자는 누가 메시지를 전송하는지 알 필요가 없다.

### 퍼블릭 인터페이스와 오퍼레이션

- 퍼블릭 인터페이스 : 객체가 의사소통을 위해 외부에 공개하는 메시지 집합
- 오퍼레이션 : 퍼블릭 인터페이스에 포함된 메시지, 인터페이스의 요소로 구현이 아닌 추상화다.
- 메서드 : 메서드는 오퍼레이션의 구현이다.

## 인터페이스와 설계품질

### 디미터 법칙

객체의 내부구조에 강하게 결합되지 않도록 협력 경로를 제한하라

- 모든 클래스 C와 C에 구현된 모든 메서드 M에 대해서 M이 메시지를 전송할 수 있는 객체는 다음과 같다.
    - C의 인스턴스 변수 클래스
    - M의 인자로 전달된 클래스
- 객체의 내부구조를 묻는 메시지보다는 수신자에게 무언가를 시키는 메시지가 더 좋은 메시지다.

### 묻지말고 시켜라

- 절차적인 코드는 정보를 얻은 후 결정한다.
- 객체지향 코드는 객체에게 그것을 하도록 시킨다.

### 의도를 드러내는 인터페이스

- 메서드의 이름은 “어떻게“ 작업을 수행하는지가 아니라, “무엇”을 하는지 드러내야 한다.
- 메서드의 이름에 어떻게 작업을 수행하는지 드러내면, 클라이언트로 하여금 협력하는 객체의 종류를 알도록 강요한다.
- 의도를 드러내는 인터페이스 : 구현과 관련된 모든 정보를 캡슐화하고, 객체의 퍼블릭 인터페이스에는 협력과 관련된 의도만을 표현해야 한다.

## 원칙의 함정

- 소프트웨어 설계에 법칙이란 존재하지 않는다. 법칙에는 예외가 없지만 원칙에는 예외가 넘쳐난다.
- 디미터 법칙은 하나의 도트를 강제하는 규칙이 아니다.
    - 도트를 여러개 사용한다 하더라도 내부 구현을 드러내지 않을 수 있다.
- 묻지말고 시켜라와 디미터 법칙은 항상 긍정적인 결과로 귀결되지는 않는다.
    - 객체 내부 상태를 가져와 사용하지 않기 위해 무작정 위임을 하게 되면, SRP를 위반할 수 있다.

## 명령 쿼리 분리원칙

- 루틴 : 어떤 절차를 묶어 호출 가능하도록 이름을 부여한 기능 모듈.
    - 프로시저 : 부수효과를 발생시킬 수 있지만 값을 반환할 수 없다.
    - 함수 : 값을 반환하지만 부수효과를 발생시킬 수 없다.
- 명령 : 객체의 상태를 변경하는 명령은 반환값을 가질 수 없다.
- 쿼리 : 객체의 정보를 반환하는 쿼리는 상태를 변경할 수 없다.
- 명령과 쿼리를 뒤섞으면 실행 결과를 예측하기 어려워 질 수 있다.

### 참조 투명성

- 동일한 인자에 대해 동일한 값을 반환해야 한다.
- 참조 투명성을 통해 기존의 값은 불변을 보장받는다.

### 함수형 프로그래밍

- 함수형 프로그래밍은 어떻게 하는지가 아닌, 무엇을 하는지에 초점을 맞춘다.

**명령형 프로그래밍**

```java
for(int i = 1 ; i < 10; i++){
    System.out.println(i);
}
```

**함수형 프로그래밍**

```java
process(10, print(num));
```

## 느낀점

명령 쿼리 분리원칙을 통해 기존에 작성하던 코드가 왜 복잡했는지 감이 잡혔다. CQRS를 한창 보고있었는데, 단순한 객체 설계에서도 명령 쿼리를 분리할 수 있었다는 사실에 기본에 좀더 충실해야겠다는 생각을 했다.

함수형 프로그래밍 레퍼런스

[https://mangkyu.tistory.com/111](https://mangkyu.tistory.com/111)
